&НаСервере
Процедура ЗагрузитьСообщенияНаСервере()
	
	Текст = Новый ЧтениеТекста;
	
	Текст.Открыть(ПутьКФайлу, "UTF-8");              
	
	Строка = Текст.ПрочитатьСтроку();
	
	Пока Строка <> Неопределено Цикл 
		
		Ярослав = "Вы, ";
		Катя = "Екатерина Бессчетнова, ";
		
		Если СтрНачинаетсяС(Строка, Ярослав) Тогда 
			ЭтоНовоеСообщение = Истина;
			Автор = Перечисления.Авторы.Ярослав;
			Строка = СтрЗаменить(Строка, Ярослав, "");
		ИначеЕсли СтрНачинаетсяС(Строка, Катя) Тогда 
			ЭтоНовоеСообщение = Истина;
			Автор = Перечисления.Авторы.Катя;
			Строка = СтрЗаменить(Строка, Катя, "");
		Иначе
			ЭтоНовоеСообщение = Ложь;
		КонецЕсли;
		
		Если ЭтоНовоеСообщение Тогда
			
			НовСтр = Сообщения.Добавить();
			НовСтр.Автор = Автор;
			
			День = Число(Лев(Строка, 2));
			
			Пробел1 = СтрНайти(Строка, " ");
			Пробел2 = СтрНайти(Строка, " ",,, 2);
			СтрМесяц = Сред(Строка, Пробел1 + 1, Пробел2 - Пробел1 - 1);
			Если СтрМесяц = "янв" Тогда 
				Месяц = 1;
			ИначеЕсли СтрМесяц = "фев" Тогда 
				Месяц = 2;
			ИначеЕсли СтрМесяц = "мар" Тогда 
				Месяц = 3;
			ИначеЕсли СтрМесяц = "апр" Тогда 
				Месяц = 4;
			ИначеЕсли СтрМесяц = "мая" Тогда 
				Месяц = 5;
			ИначеЕсли СтрМесяц = "июн" Тогда 
				Месяц = 6;
			ИначеЕсли СтрМесяц = "июл" Тогда 
				Месяц = 7;
			ИначеЕсли СтрМесяц = "авг" Тогда 
				Месяц = 8;
			ИначеЕсли СтрМесяц = "сен" Тогда 
				Месяц = 9;
			ИначеЕсли СтрМесяц = "окт" Тогда 
				Месяц = 10;
			ИначеЕсли СтрМесяц = "ноя" Тогда 
				Месяц = 11;
			ИначеЕсли СтрМесяц = "дек" Тогда 
				Месяц = 12;
			Иначе 
				Сообщение = Новый СообщениеПользователю;
				Сообщение.Текст = "Ошибка в дате!";
				Сообщение.Сообщить();
			КонецЕсли;
			
			Пробел3 = СтрНайти(Строка, " ",,, 3);
			Год = Число(Сред(Строка, Пробел2 + 1, Пробел3 - Пробел2 - 1));
			
			Пробел4 = СтрНайти(Строка, " ",,, 4);
			Двоеточие1 = СтрНайти(Строка, ":");
			Час = Число(Сред(Строка, Пробел4 + 1, Двоеточие1 - Пробел4 - 1));
			
			Двоеточие2 = СтрНайти(Строка, ":",,, 2);
			Минута = Число(Сред(Строка, Двоеточие1 + 1, Двоеточие2 - Двоеточие1 - 1));
			
			Секунда = Число(Сред(Строка, Двоеточие2 + 1));
			
			НовСтр.Дата = Дата(Год, Месяц, День, Час, Минута, Секунда);
			
		Иначе
			НовСтр.Сообщение = НовСтр.Сообщение + Строка;			
		КонецЕсли;
		
		Строка = Текст.ПрочитатьСтроку();
		
	КонецЦикла; 
	
	Сообщения.Сортировать("Дата");	
	
КонецПроцедуры

&НаКлиенте
Процедура ПутьКФайлуНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	ДиалогВыбора = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДиалогВыбора.Заголовок = "Выберите файл";
	
	Если ДиалогВыбора.Выбрать() Тогда   
		ПутьКФайлу = ДиалогВыбора.ПолноеИмяФайла; 
	КонецЕсли;
	
КонецПроцедуры
