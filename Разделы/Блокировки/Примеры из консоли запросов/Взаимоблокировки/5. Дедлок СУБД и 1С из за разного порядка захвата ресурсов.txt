// выполнить в двух окнах в АВТОМАТИЧЕСКОМ режиме блокировок  
// можно использовать Extended events/Profiler для расследования
// смотреть события Lock_deadlock, Lock_escalation

Запрос = Новый Запрос("ВЫБРАТЬ ПЕРВЫЕ 1 Ссылка ИЗ Документ.БезТабличныхЧастей"); 
Выб = Запрос.Выполнить().Выбрать(); Выб.Следующий();

НачатьТранзакцию();

	// шаг 1: читаем объект и устанавливаем S-блокировку
	Объект = Выб.Ссылка.ПолучитьОбъект();
	Объект.НомерЯчейки = Объект.НомерЯчейки + 1;
	Предупреждение("Шаг 1. Получен объект");
	
	// шаг 2: записываем объект и устанавливаем Х-блокировку
	Объект.Записать();
	Предупреждение("Шаг 2. Записан объект");
	
ОтменитьТранзакцию();
