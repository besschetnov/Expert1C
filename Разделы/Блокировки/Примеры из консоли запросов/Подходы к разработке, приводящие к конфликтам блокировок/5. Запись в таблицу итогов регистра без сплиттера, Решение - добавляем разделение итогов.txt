// выполнять в управляемом режиме блокировок 
// нагляднее будет, если таблица итогов пуста, лучше сделать truncate table [TrProf83]..[_AccumRgT414]
// блокировки не будет, потому что разделение итогов включено
// будут добавлены 2 записи в таблице итогов, с одним значением периода и измерениями, 
// но с разными значениями служебного поля _Splitter
Запрос = Новый Запрос("ВЫБРАТЬ ПЕРВЫЕ 2 Ссылка, Дата ИЗ Документ.БезТабличныхЧастей ГДЕ НЕ Проведен И НЕ ПометкаУдаления");
ТаблицаЗапроса = Запрос.Выполнить().Выгрузить();

НачатьТранзакцию();

	Док = ТаблицаЗапроса[0].Ссылка;	// во втором окне используем Док = ТаблицаЗапроса[1].Ссылка;
	Период = НАЧАЛОГода(ТаблицаЗапроса[0].Дата); // во втором окне используем КОНЕЦГода(ТаблицаЗапроса[1].Дата);
	
	Набор = РегистрыНакопления.СоСплиттером.СоздатьНаборЗаписей();
	Набор.Отбор.Регистратор.Установить(Док);
	
	Стр = Набор.Добавить();
	Стр.ВидДвижения = ВидДвиженияНакопления.Приход;
	Стр.Регистратор = Док;
	Стр.Период = Период;
	Стр.Товар = Справочники.Товары.Смартфон;
	Стр.Количество = 1;
	
	Набор.Записать();

	Предупреждение("Записали набор");
	
ОтменитьТранзакцию();
